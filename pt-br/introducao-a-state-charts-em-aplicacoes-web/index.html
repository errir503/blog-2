<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/blog/styles.24b4a7ab24971c9ba768.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.FloatMenu-module--menu--3DIQJ{position:fixed;bottom:-1px;right:0;cursor:pointer;padding:20px;width:100%;background:#fff;transform:translateY(187px);color:#22272c;transition:transform .2s,background .2s,color .2s}.FloatMenu-module--option--Fgcwy{transition:transform .2s;margin-right:10px;border:none;background:transparent;display:inline-block}.FloatMenu-module--option--Fgcwy:hover{cursor:pointer;transform:scale(1.2)}.FloatMenu-module--flag--1gcwG{width:30px;border-radius:4px}.FloatMenu-module--vader--PLIU6{width:34px;height:30px}.FloatMenu-module--trooper--OWxUE{width:28px}.FloatMenu-module--title--21W0t{padding-right:20px}.FloatMenu-module--subtitle--PTEKX{margin-top:20px;margin-bottom:10px}.FloatMenu-module--avatar--2Zizz{cursor:pointer;position:absolute;top:-37px;z-index:999999999;width:50px;right:20px;transition:top .2s}.FloatMenu-module--avatar--2Zizz:hover{top:-55px}.FloatMenu-module--openSettings--2rlaT{visibility:hidden}.FloatMenu-module--openSettings--2rlaT:checked~.FloatMenu-module--menu--3DIQJ{transform:translateY(0)}.FloatMenu-module--openSettings--2rlaT:checked~.FloatMenu-module--menu--3DIQJ .FloatMenu-module--avatar--2Zizz:hover{top:-37px}body.light-theme .FloatMenu-module--menu--3DIQJ{background:#22272c;color:#fff}@media(max-width:780px){.FloatMenu-module--menu--3DIQJ{transform:translateY(202px)}.FloatMenu-module--avatar--2Zizz{right:10px}}*{margin:0;padding:0;box-sizing:border-box;font-family:Press Start\ 2P,cursive}body{background:#22272c;color:#fff;transition:background .2s,color .2s}body.light-theme{color:#22272c;background:#fff}.global-module--container--ny7W9{max-width:1020px;margin:0 auto}.global-module--prefetchLink--hIA84{visibility:hidden;font-size:0}.PostList-module--posts--2R_sN{display:flex;flex-wrap:wrap;justify-content:flex-start;gap:20px}.PostList-module--post--13-tS{width:calc(33.33% - 20px);background-color:#404447;padding:20px 20px 30px;box-shadow:none;text-decoration:none;position:relative;color:#fff;min-height:220px}.PostList-module--title--3NqQ3{text-decoration:none;font-size:13px;margin-bottom:20px;line-height:1.9em;min-height:48px}.PostList-module--description--39upC{font-family:Roboto,sans-serif;font-size:14px;line-height:1.5em}.PostList-module--date--3Ygsq{font-size:8px;position:absolute;bottom:10px;right:20px;padding:4px}@media(max-width:1040px){.PostList-module--posts--2R_sN{padding:0 20px}}@media(max-width:780px){.PostList-module--posts--2R_sN{display:block}.PostList-module--post--13-tS{display:block;width:100%;margin-right:0;margin-bottom:20px}}.blog-post-module--root--hhWTX{max-width:780px}.blog-post-module--content--c97Ib{padding-bottom:60px;margin:0 auto}.blog-post-module--content--c97Ib *{font-family:Roboto,sans-serif;font-size:18px;line-height:1.58em}.blog-post-module--content--c97Ib p{margin:30px 0}.blog-post-module--content--c97Ib h1,.blog-post-module--content--c97Ib h2,.blog-post-module--content--c97Ib h3,.blog-post-module--content--c97Ib h4,.blog-post-module--content--c97Ib h5,.blog-post-module--content--c97Ib h6{font-family:Press Start\ 2P,cursive;margin:30px 0}.blog-post-module--content--c97Ib h2{font-size:20px}.blog-post-module--content--c97Ib h3{font-size:14px}.subtitle--separator:before{content:". . .";display:block;width:100%;text-align:center;margin-bottom:50px;margin-top:50px}.language-text{color:#d78838!important;border:1px solid #3c3e42;padding:0 4px;border-radius:4px}.language-js,.language-js span{font-family:Fira Code,monospace!important}.blog-post-module--content--c97Ib a{display:inline-block;color:#d78838}.blog-post-module--content--c97Ib ol,.blog-post-module--content--c97Ib ul{margin:20px 0;list-style:none}.blog-post-module--content--c97Ib ul li{margin-bottom:10px}.blog-post-module--content--c97Ib ul li:before{content:"=>";font-family:Press Start\ 2P,cursive;font-size:10px;padding-right:10px;color:#d78838}.blog-post-module--content--c97Ib blockquote{border-left:4px solid #3e7068;padding-left:10px;margin:40px 0 40px 18px}.blog-post-module--content--c97Ib img{max-width:100%;-o-object-fit:cover;object-fit:cover;display:block;margin:0 auto}@media(max-width:1040px){.blog-post-module--content--c97Ib{padding:1.4em}}.blog-post-module--disqus-container--1fggW{padding:0}@media(max-width:780px){.blog-post-module--disqus-container--1fggW{padding:0 1.4em}}.BackButton-module--button--NQDXr{font-size:18px;color:#fff;background:transparent;border:none;margin-top:20px;text-decoration:none;display:block;position:relative;transition:left .3s;left:0}.BackButton-module--button--NQDXr:hover{left:-4px}body.light-theme .BackButton-module--button--NQDXr{color:#22272c}@media(max-width:1040px){.BackButton-module--button--NQDXr{padding-left:12px}}.layout-module--title--2pFnw{font-size:24px;text-align:center;padding:50px 20px 30px;line-height:34px}.layout-module--link--9VMjY{box-shadow:none;text-decoration:none;color:inherit}@media(max-width:780px){.layout-module--title--2pFnw{padding:70px 20px 60px}}</style><meta name="generator" content="Gatsby 2.27.0"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=8e659aea3a609f7031f6051b55e1472a" type="image/png"/><link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#fff"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=8e659aea3a609f7031f6051b55e1472a"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=8e659aea3a609f7031f6051b55e1472a"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=8e659aea3a609f7031f6051b55e1472a"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=8e659aea3a609f7031f6051b55e1472a"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=8e659aea3a609f7031f6051b55e1472a"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=8e659aea3a609f7031f6051b55e1472a"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=8e659aea3a609f7031f6051b55e1472a"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=8e659aea3a609f7031f6051b55e1472a"/><title data-react-helmet="true">Introdução a state charts em aplicações web | Diel Duarte blog</title><meta data-react-helmet="true" name="description" content="Era uma vez um Front-end que não conhecia State Chartse e tinha uma tarefa muito &quot;simples&quot;..."/><meta data-react-helmet="true" property="og:title" content="Introdução a state charts em aplicações web"/><meta data-react-helmet="true" property="og:description" content="Era uma vez um Front-end que não conhecia State Chartse e tinha uma tarefa muito &quot;simples&quot;..."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="https://dielduarte.dev/blog/images/web-development-with-state-charts-intro/image-7.png"/><meta data-react-helmet="true" property="twitter:image" content="https://dielduarte.dev/blog/images/web-development-with-state-charts-intro/image-7.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="Diel Duarte"/><meta data-react-helmet="true" name="twitter:title" content="Introdução a state charts em aplicações web"/><meta data-react-helmet="true" name="twitter:description" content="Era uma vez um Front-end que não conhecia State Chartse e tinha uma tarefa muito &quot;simples&quot;..."/><link href="https://fonts.googleapis.com/css?family=Press+Start+2P|Roboto|Fira+Code&amp;display=swap" rel="stylesheet"/><link as="script" rel="preload" href="/blog/webpack-runtime-afd5e85def11657c3dfa.js"/><link as="script" rel="preload" href="/blog/framework-dbb498007a7447f28d8e.js"/><link as="script" rel="preload" href="/blog/app-41047341e2e61b8de57d.js"/><link as="script" rel="preload" href="/blog/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/blog/commons-887a419bdf88aca30d58.js"/><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-js-75fd52bd8a284827f8e6.js"/><link as="fetch" rel="preload" href="/blog/page-data/pt-br/introducao-a-state-charts-em-aplicacoes-web/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-module--container--ny7W9 blog-post-module--root--hhWTX"><a class="BackButton-module--button--NQDXr" href="/blog/">&lt;=</a><header><h1 class="layout-module--title--2pFnw">Introdução a state charts em aplicações web</h1></header><main><a class="global-module--prefetchLink--hIA84" href="/blog/en/web-development-with-state-charts-intro">/en/web-development-with-state-charts-intro</a><div class="blog-post-module--content--c97Ib"><p>Era uma vez um Front-end que não conhecia State Charts e tinha uma tarefa muito “simples”, construir um componente de input. O  “simples” input para edição de um nome tinha algumas variações de estados:</p>
<p><code class="language-text">inicial</code>: O input aparece desabilitado, o usuário pode então clicar no ícone de editar. </p>
<p><code class="language-text">editando</code>: O input está habilitado para receber o novo valor de nome, o usuário pode então clicar no ícone de salvar.</p>
<p><code class="language-text">salvando</code>: No lugar dos ícones de editar/salvar mostramos um loading sinalizando que alguma ação assíncrona está acontecendo, nesse caso, estamos salvando o novo valor de nome.</p>
<p><img src="/blog/images/web-development-with-state-charts-intro/image-1.jpg" alt="imagem mostrando o component de input e seus estados."> </p>
<h2 class="subtitle--separator"></h2>
<p>Nosso querido Front-end começou a implementação com duas variáveis boleanas:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">isEditing <span class="token operator">=</span> <span class="token boolean">false</span>
isSaving <span class="token operator">=</span> <span class="token boolean">false</span></code></pre></div>
<p>E uma função de <strong><em>onClick</em></strong> que recebia por parametro os valores de <code class="language-text">isEditing</code> e <code class="language-text">isSaving</code>.  Seu pensamento foi: A primeira vez que a função de onClick for chamada, estamos no estado inicial, logo preciso enviar o usuário para o estado de <strong><em>editando</em></strong>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token parameter">isEditing<span class="token punctuation">,</span> isSaving</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isEditing <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isSaving<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isEditing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><img src="/blog/images/web-development-with-state-charts-intro/image-2.jpg" alt="imagem mostrando o component de input em seu estado inicial e mostrando que o ícone editar possui um evento de on click."> </p>
<p>Ao chegar no estado de edição e sabendo que o usuário poderia novamente clicar no ícone que dessa vez se transformava no ícone para salvar, o mesmo continuou sua implementação adicionando mais um trecho código na função de <strong><em>onClick</em></strong>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token parameter">isEditing<span class="token punctuation">,</span> isSaving</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isEditing <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isSaving<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isEditing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>isEditing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isEditing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    isSaving <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token function">saveName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       isSaving <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
       isEditing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>O trecho de código adicionado primeiro testa se o usuário está no estado de <strong><em>edição</em></strong>, caso verdadeiro, faz o switch das variáveis para levar o usuário para o estado de <strong><em>salvando</em></strong>, e logo em seguida faz um request na api para salvar o novo valor de nome. Ao receber um retorno da api, resetamos as duas variáveis boleanas para false, pois agora, o usuário não está editando e nem salvando um novo valor, o que supostamente levaria o usuário para o estado <strong><em>inicial</em></strong>.</p>
<p><img src="/blog/images/web-development-with-state-charts-intro/image-3.png" alt="imagem mostrando o component de input saindo do esado de editando para salvando, e depois de salvando para inicial."></p>
<p>Não muito confiante na solução, deu a task como terminada e seguiu sua vida.</p>
<p><img src="/blog/images/web-development-with-state-charts-intro/gif-1.gif" alt="gif de um menino nerd dando joinha."></p>
<h2 class="subtitle--separator"></h2>
<p>…Era uma vez um designer, que esqueceu de trabalhar no estado de erro do “simples” componente de input.</p>
<p><strong><em>“Hey dev, Esqueci de um detalhe, não tratamos o estado de erro do input. Quando der erro, volta pro estado de edição por que o cliente pode tentar salvar novamente.”</em></strong></p>
<p>Mesmo sabendo que a solução atual não era a ideal, continuou com a mesma implementação para adicionar o estado de erro, agora, ao invés de 2 variáveis boleanas, seriam três:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">isEditing <span class="token operator">=</span> <span class="token boolean">false</span>
isSaving <span class="token operator">=</span> <span class="token boolean">false</span>
isError <span class="token operator">=</span> <span class="token boolean">false</span></code></pre></div>
<p>Essa pequena adição resultou na função de onClick abaixo:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token parameter">isEditing<span class="token punctuation">,</span> isSaving<span class="token punctuation">,</span> isError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isEditing <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isSaving<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isEditing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>isEditing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isEditing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    isSaving <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    isError <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token function">saveName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       isSaving <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
       isEditing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
       isError <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
       isSaving <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
       isEditing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Task concluida novamente.
Desconfortável com a solução final, foi pesquisar. Afinal, qual o problema com variáveis boleanas? </p>
<p><img src="/blog/images/web-development-with-state-charts-intro/image-4.png" alt="imagem mostrando que podemos ter 8 variações usando 3 variáveis booleanas."></p>
<p>O problema é que como na imagem acima, apesar de parecer inofensiva e óbvio, 1 variável boleana representa duas variações. O porém que ninguém lembra é que adicionando mais de uma variável, suas variações crescem exponencialmente. Com três variáveis boleanas como no exemplo acima, temos 8 variações.</p>
<p>E aí, você acha que o código acima está preparado para lidar com 8 variações? A resposta infelizmente é: não. Seu código pode parecer simples e estar 99% vunerável a bugs.</p>
<p><img src="/blog/images/web-development-with-state-charts-intro/image-5.jpg" alt="meme de um homem tampando a placa do carro pela metada na primeira parte da foto, e na segunda parte tampando a outra."></p>
<p>Sabendo disso, podemos fazer diferente, podemos mapear todos os estados em uma constante:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> stateType <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'IDLE'</span><span class="token operator">:</span> <span class="token string">'IDLE'</span><span class="token punctuation">,</span>
  <span class="token string">'EDITING'</span><span class="token operator">:</span> <span class="token string">'EDITING'</span><span class="token punctuation">,</span>
  <span class="token string">'SAVING'</span><span class="token operator">:</span> <span class="token string">'SAVING'</span><span class="token punctuation">,</span>
  <span class="token string">'ERROR'</span><span class="token operator">:</span> <span class="token string">'ERROR'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>Podemos também criar um objeto que nos diga qual o estado atual e qual o próximo estado, exemplo:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"> <span class="token keyword">const</span> nextState <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token punctuation">[</span>stateType<span class="token punctuation">.</span><span class="token constant">IDLE</span><span class="token punctuation">]</span><span class="token operator">:</span> stateType<span class="token punctuation">.</span><span class="token constant">EDITING</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span>stateType<span class="token punctuation">.</span><span class="token constant">EDITING</span><span class="token punctuation">]</span><span class="token operator">:</span> stateType<span class="token punctuation">.</span><span class="token constant">SAVING</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span>stateType<span class="token punctuation">.</span><span class="token constant">SAVING</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     success<span class="token operator">:</span> stateType<span class="token punctuation">.</span><span class="token constant">IDLE</span><span class="token punctuation">,</span>
     error<span class="token operator">:</span> stateType<span class="token punctuation">.</span><span class="token constant">ERROR</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span>stateType<span class="token punctuation">.</span><span class="token constant">ERROR</span><span class="token punctuation">]</span><span class="token operator">:</span> stateType<span class="token punctuation">.</span><span class="token constant">SAVING</span>
 <span class="token punctuation">}</span></code></pre></div>
<p>Limitaremos então o estado do input para apenas UM estado por vez:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">inputState <span class="token operator">=</span> stateType<span class="token punctuation">.</span><span class="token constant">IDLE</span></code></pre></div>
<p>E nossa função de onClick receberia apenas o nosso estado atual por parâmetro, e usando o objecto nextState, saberiamos qual o próximo estado deveríamos mover nosso componente. Exemplo:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token parameter">currentInputState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>currentInputState <span class="token operator">===</span> stateType<span class="token punctuation">.</span><span class="token constant">EDITING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">saveName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> currentInputState <span class="token operator">===</span> nextState<span class="token punctuation">[</span>stateType<span class="token punctuation">.</span>saving<span class="token punctuation">]</span><span class="token punctuation">.</span>success<span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> currentInputState <span class="token operator">===</span> nextState<span class="token punctuation">[</span>stateType<span class="token punctuation">.</span>saving<span class="token punctuation">]</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
	  currentInputState <span class="token operator">=</span> nextState<span class="token punctuation">[</span>currentInputState<span class="token punctuation">]</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Podemos resumir nossa história em problema e solução:</p>
<p><code class="language-text">Problema:</code></p>
<p>Manter o estado usando variáveis condicionais ficou confuso, além de obrigar a tratar todos os edge cases e rezar para que o estado não caísse em possíveis combinações que não foram tratadas.</p>
<p><code class="language-text">Solução:</code></p>
<p>Ter um único estado por vez e definir as transições entre estados através de um evento.</p>
<h2 class="subtitle--separator"></h2>
<p>Nossa solução tem um nome: <code class="language-text">Finite State Machines</code>, mas a final oq é Finite State Machines? </p>
<blockquote>
<p>Uma Máquina de estados finita (Finite State Machines ou FSM) é um modelo matemático usado para representar programas de computadores ou circuitos lógicos. O conceito é concebido como uma máquina abstrata que deve estar em <strong>UM</strong> de um número finito de estados.</p>
</blockquote>
<p>source: <a href="https://pt.wikipedia.org/wiki/M%C3%A1quina_de_estados_finita">https://pt.wikipedia.org/wiki/Máquina<em>de</em>estados_finita</a></p>
<p>Uma forma bem simples de representar FSM é usando um diagrama de transição de estados, onde o conseguimos vizualizar todo o fluxo de transição de estados por exemplo:</p>
<p><strong><em>começando em um estado A ⇒ um vento X aconteceu ⇒ vamos para um estado B</em></strong></p>
<p><img src="/blog/images/web-development-with-state-charts-intro/image-6.png" alt="imagem mostrando um diagrama de transição de estados"></p>
<h3>Finite State Machines? State charts? que confusão!</h3>
<p>Quando começamos a estudar mais sobre Finete State Machines vamos sempre nos deparar com um outro nome que é <code class="language-text">State Charts</code>, mas a propósito qual a grande diferença entre eles? </p>
<p>Como qualquer solução, Finite State Machines por sí só tem alguns problemas, geralmente acabam com um grande número de estados, muitos deles com transições idênticas, tornando muito verboso e de difícil manutenção. Este é o famoso problema conhecido como explosão de estados.</p>
<p>State Charts por sua vez, apareceu pouco tempo depois adicionando soluções para que FSM fossem mais escalável a medida que o seu sistema fosse crescendo e ficando mais complexo. Além de novas ideias para tornar sua vida mais fácil.</p>
<p><img src="/blog/images/web-development-with-state-charts-intro/image-7.png" alt="imagem mostrando alguns dos conceitos que state charts contém, como activity, actions, paralel states entre outros..."></p>
<p>Vale lembrar que a ideia foi apresentada há mais de 20 anos atrás, além de ser uma das bases da computação, é usada largamente em hardware embarcados e games! Com o aparecimento da lib Xstate que vamos descobrir no próximo post, o uso na web e pricipalmente usando Javascript está crescendo cada vez mais. Apenas para deixar um gostinho do que vamos ver no próximo artigo e também sobre uma das maiores vantagens de se usar State Charts que é o poder de vizualizar seu código, dá uma olhada como ficaria nosso codigo do componente de input usando Xstate:</p>
<p><a href="https://xstate.js.org/viz/?gist=d73e129d583ac4a0ba956736e68dbdd2">https://xstate.js.org/viz/?gist=d73e129d583ac4a0ba956736e68dbdd2</a></p>
<p>Não se preocupe se não entendeu o código, vamos aprender tudo sobre o uso de Xstate e State Charts em uma aplicação real no próximo artigo!</p>
<h3>Estado? É tipo redux?</h3>
<p>Quando trabalhamos com State Charts, os famosos estados não são os estados dinâmicos ou relacionados a dados de uma aplicação e sim em qual cenário de uma possibilidade finita e pré estabelecida uma aplicação está, lembre-se da regra de ouro, uma aplicação pode estar em UM único estado por vez. Exemplo:</p>
<p>Sua aplicação pode estar no estado de loading e ter um contexto <code class="language-text">user=null</code>, em uma próximo momento sua aplicação estaria em um estado de logado e ter um contexto <code class="language-text">user={ id: 1, name:  &#39;Diel&#39; }</code>. Com esse exemplo fica fácil assimilar que o estado como estamos acostumados no Redux ou outras opções são chamados de contexto no mundo dos statecharts.</p>
<p>Te vejo no próximo post, onde vamos aprender a como modelar uma aplicação utilizando State Charts e Xstate.</p></div><section class="blog-post-module--disqus-container--1fggW"><div id="disqus_thread"></div></section></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-144025823-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/pt-br/introducao-a-state-charts-em-aplicacoes-web/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-ca8adf9770cfeec4c092.js"],"app":["/app-41047341e2e61b8de57d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-a4c8c90d54199b46c394.js"],"component---src-pages-pt-br-js":["/component---src-pages-pt-br-js-0a783226c21806dbdbec.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-75fd52bd8a284827f8e6.js"]};/*]]>*/</script><script src="/blog/polyfill-ca8adf9770cfeec4c092.js" nomodule=""></script><script src="/blog/component---src-templates-blog-post-js-75fd52bd8a284827f8e6.js" async=""></script><script src="/blog/commons-887a419bdf88aca30d58.js" async=""></script><script src="/blog/styles-407fe62976dc5310c43e.js" async=""></script><script src="/blog/app-41047341e2e61b8de57d.js" async=""></script><script src="/blog/framework-dbb498007a7447f28d8e.js" async=""></script><script src="/blog/webpack-runtime-afd5e85def11657c3dfa.js" async=""></script></body></html>